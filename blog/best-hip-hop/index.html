<!DOCTYPE html>
<html lang="en" dir="ltr"><head>
  
                           
     


<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.91.2" />
<title>PCA and the #TidyTuesday best hip hop songs ever | Julia Silge</title>


<meta property="twitter:site" content="@juliasilge">
<meta property="twitter:creator" content="@juliasilge">







  
    
  
<meta name="description" content="A data science blog">


<meta property="og:site_name" content="Julia Silge">
<meta property="og:title" content="PCA and the #TidyTuesday best hip hop songs ever | Julia Silge">
<meta property="og:description" content="A data science blog" />
<meta property="og:type" content="page" />
<meta property="og:url" content="https://juliasilge.com/blog/best-hip-hop/" />
<meta property="og:locale" content="en">




    
        <meta property="og:image" content="https://juliasilge.com/blog/best-hip-hop/featured.png" >
        <meta property="twitter:card" content="summary_large_image">
        <meta name="twitter:image" content="https://juliasilge.com/blog/best-hip-hop/featured.png" >
    
    
  <meta itemprop="name" content="PCA and the #TidyTuesday best hip hop songs ever">
<meta itemprop="description" content="Lately I&rsquo;ve been publishing screencasts demonstrating how to use the tidymodels framework, from first steps in modeling to how to tune more complex models. Today, I&rsquo;m exploring a different part of the tidymodels framework; I&rsquo;m showing how to implement principal component analysis via recipes with this week&rsquo;s #TidyTuesday dataset on the best hip hop songs of all time as determinded by a BBC poll of music critics.
   Here is the code I used in the video, for those who prefer reading instead of or in addition to video."><meta itemprop="datePublished" content="2020-04-14T00:00:00+00:00" />
<meta itemprop="dateModified" content="2020-04-14T00:00:00+00:00" />
<meta itemprop="wordCount" content="2491"><meta itemprop="image" content="https://juliasilge.com/blog/best-hip-hop/featured.png">
<meta itemprop="keywords" content="rstats,tidymodels," />
  
  
  <!--[if IE]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <link rel="shortcut icon" href="/img/icon.png" type="image/x-icon">
  <link rel="icon" href="/img/icon.png" type="image/x-icon">
  
  
  <link rel="stylesheet" href="/style.main.min.34750661ca065ca7ddb87b2b28cab82abf493a21c1e3852e0755fba776b031b7.css" integrity="sha256-NHUGYcoGXKfduHsrKMq4Kr9JOiHB44UuB1X7p3awMbc=" media="screen">
  
  
  <script src="/panelset.min.078a92db9bd3228df502db3d9e0453c3cf3d910abe3f8deca0ad196c7071ad41.js" type="text/javascript"></script>
  
  
  <script src="/main.min.bb67dea4a2ee41aab688effd180f2d02662e47280f0021495f2c0ce24c461f65.js" type="text/javascript"></script>
</head>
<body>
      <div class="grid-container">
<header class="site-header pt4 pb2 mb4 bb b--transparent ph5 headroom z-max" role="banner">
  <nav class="site-nav db dt-l w-100" role="navigation">
    <a class="site-brand db dtc-l v-mid link no-underline w-100 w-33-l tc tl-l" href="https://juliasilge.com/" title="Home">
      <span class="f4 fw7">Julia Silge</span>
    </a>
    <div class="site-links db dtc-l v-mid w-100 w-47-l tc tr-l mt3 mt0-l ttu tracked">
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/about/" title="About me">About</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 active" href="/blog/" title="Blog">Blog</a>
      
      
    </div>
  </nav>
</header>

<main class="page-main pa4" role="main">
  <section class="page-content mw7 center">
    <article class="post-content pa0 ph4-l">
      <header class="post-header">
        <h1 class="f1 lh-solid measure-narrow mb3 fw4">PCA and the #TidyTuesday best hip hop songs ever</h1>
        
        <p class="f6 measure lh-copy mv1">By Julia Silge in <a href="https://juliasilge.com/categories/rstats">rstats</a>  <a href="https://juliasilge.com/categories/tidymodels">tidymodels</a> </p>
        <p class="f7 db mv0 ttu">April 14, 2020</p>

      

      </header>
      <section class="post-body pt5 pb4">
        <p>Lately I&rsquo;ve been publishing 
<a href="https://juliasilge.com/tags/tidymodels/" target="_blank" rel="noopener">screencasts</a> demonstrating how to use the tidymodels framework, from first steps in modeling to how to tune more complex models. Today, I&rsquo;m exploring a different part of the tidymodels framework; I&rsquo;m showing how to implement principal component analysis via recipes with this week&rsquo;s 
<a href="https://github.com/rfordatascience/tidytuesday" target="_blank" rel="noopener"><code>#TidyTuesday</code> dataset</a> on the best hip hop songs of all time as determinded by a BBC poll of music critics.</p>
<!--html_preserve-->
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube-nocookie.com/embed/OvgzIx5mDNM" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>
<!--/html_preserve-->
</br>
<p>Here is the code I used in the video, for those who prefer reading instead of or in addition to video.</p>




<h2 id="explore-the-data">Explore the data
  <a href="#explore-the-data"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h2>
<p>Our modeling goal here is to understand what kind of songs are more highly rated by music critics in the 
<a href="https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-04-14/readme.md" target="_blank" rel="noopener">#TidyTuesday dataset</a> on hip hop songs. We&rsquo;ll use principal component analysis and audio features available in the Spotify API to do this! ðŸŽµ</p>
<p>First, let&rsquo;s look at the data on the rankings.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#06287e">library</span>(tidyverse)

rankings <span style="color:#666">&lt;-</span> <span style="color:#06287e">read_csv</span>(<span style="color:#4070a0">&#34;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-04-14/rankings.csv&#34;</span>)

rankings
</code></pre></div><pre tabindex="0"><code>## # A tibble: 311 x 12
##       ID title   artist   year gender points     n    n1    n2    n3    n4    n5
##    &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     1 Juicy   The Noâ€¦  1994 male      140    18     9     3     3     1     2
##  2     2 Fight â€¦ Publicâ€¦  1989 male      100    11     7     3     1     0     0
##  3     3 Shook â€¦ Mobb Dâ€¦  1995 male       94    13     4     5     1     1     2
##  4     4 The Meâ€¦ Grandmâ€¦  1982 male       90    14     5     3     1     0     5
##  5     5 Nuthinâ€¦ Dr Dreâ€¦  1992 male       84    14     2     4     2     4     2
##  6     6 C.R.E.â€¦ Wu-Tanâ€¦  1993 male       62    10     3     1     1     4     1
##  7     7 93 â€™Tiâ€¦ Souls â€¦  1993 male       50     7     2     2     2     0     1
##  8     8 Passinâ€¦ The Phâ€¦  1992 male       48     6     3     2     0     0     1
##  9     9 N.Y. Sâ€¦ Nas      1994 male       46     7     1     3     1     1     1
## 10    10 Dear Mâ€¦ 2Pac     1995 male       42     6     2     1     1     2     0
## # â€¦ with 301 more rows
</code></pre><p>As a first step, let&rsquo;s recreate the plot from the 
<a href="https://blog.datawrapper.de/best-hip-hop-songs-of-all-time-visualized/" target="_blank" rel="noopener">source material</a>, but adjusted a bit.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">rankings <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">ggplot</span>(<span style="color:#06287e">aes</span>(year, points, color <span style="color:#666">=</span> gender)) <span style="color:#666">+</span>
  <span style="color:#06287e">geom_jitter</span>(alpha <span style="color:#666">=</span> <span style="color:#40a070">0.7</span>) <span style="color:#666">+</span>
  <span style="color:#06287e">scale_y_log10</span>() <span style="color:#666">+</span>
  <span style="color:#06287e">labs</span>(
    y <span style="color:#666">=</span> <span style="color:#4070a0">&#34;Critic rating&#34;</span>,
    x <span style="color:#666">=</span> <span style="color:#007020;font-weight:bold">NULL</span>,
    color <span style="color:#666">=</span> <span style="color:#007020;font-weight:bold">NULL</span>
  )
</code></pre></div><img src="/blog/best-hip-hop/index_files/figure-html/unnamed-chunk-3-1.png" width="2400" />
<p>To see more examples of EDA for this dataset, you can see the great work 
<a href="https://twitter.com/hashtag/tidytuesday" target="_blank" rel="noopener">that folks share on Twitter</a>! âœ¨ Next, let&rsquo;s get audio features from the Spotify API.</p>




<h2 id="get-audio-features">Get audio features
  <a href="#get-audio-features"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h2>
<p>Spotify makes a 
<a href="https://developer.spotify.com/documentation/web-api/reference/tracks/get-audio-features/" target="_blank" rel="noopener">set of &ldquo;audio features&rdquo; available</a> in its API. This includes features like whether the song is in a major or minor key, the liveness, the instrumentalness, the danceability, and many others. One option to work with these songs would be to get them all at once via a 
<a href="https://open.spotify.com/playlist/7esD007S7kzeSwVtcH9GFe?si=IHkRIwQoRjqYijDTmAURxQ" target="_blank" rel="noopener">playlist that Tom Mock made</a>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#06287e">library</span>(spotifyr)
access_token <span style="color:#666">&lt;-</span> <span style="color:#06287e">get_spotify_access_token</span>()

playlist_features <span style="color:#666">&lt;-</span> <span style="color:#06287e">get_playlist_audio_features</span>(<span style="color:#4070a0">&#34;tmock1923&#34;</span>, <span style="color:#4070a0">&#34;7esD007S7kzeSwVtcH9GFe&#34;</span>)

playlist_features
</code></pre></div><pre tabindex="0"><code>## # A tibble: 250 x 61
##    playlist_id playlist_name playlist_img playlist_owner_â€¦ playlist_owner_â€¦
##    &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt;        &lt;chr&gt;            &lt;chr&gt;           
##  1 7esD007S7kâ€¦ Top 250 Hiphâ€¦ https://mosâ€¦ tmock1923        tmock1923       
##  2 7esD007S7kâ€¦ Top 250 Hiphâ€¦ https://mosâ€¦ tmock1923        tmock1923       
##  3 7esD007S7kâ€¦ Top 250 Hiphâ€¦ https://mosâ€¦ tmock1923        tmock1923       
##  4 7esD007S7kâ€¦ Top 250 Hiphâ€¦ https://mosâ€¦ tmock1923        tmock1923       
##  5 7esD007S7kâ€¦ Top 250 Hiphâ€¦ https://mosâ€¦ tmock1923        tmock1923       
##  6 7esD007S7kâ€¦ Top 250 Hiphâ€¦ https://mosâ€¦ tmock1923        tmock1923       
##  7 7esD007S7kâ€¦ Top 250 Hiphâ€¦ https://mosâ€¦ tmock1923        tmock1923       
##  8 7esD007S7kâ€¦ Top 250 Hiphâ€¦ https://mosâ€¦ tmock1923        tmock1923       
##  9 7esD007S7kâ€¦ Top 250 Hiphâ€¦ https://mosâ€¦ tmock1923        tmock1923       
## 10 7esD007S7kâ€¦ Top 250 Hiphâ€¦ https://mosâ€¦ tmock1923        tmock1923       
## # â€¦ with 240 more rows, and 56 more variables: danceability &lt;dbl&gt;,
## #   energy &lt;dbl&gt;, key &lt;int&gt;, loudness &lt;dbl&gt;, mode &lt;int&gt;, speechiness &lt;dbl&gt;,
## #   acousticness &lt;dbl&gt;, instrumentalness &lt;dbl&gt;, liveness &lt;dbl&gt;, valence &lt;dbl&gt;,
## #   tempo &lt;dbl&gt;, track.id &lt;chr&gt;, analysis_url &lt;chr&gt;, time_signature &lt;int&gt;,
## #   added_at &lt;chr&gt;, is_local &lt;lgl&gt;, primary_color &lt;lgl&gt;, added_by.href &lt;chr&gt;,
## #   added_by.id &lt;chr&gt;, added_by.type &lt;chr&gt;, added_by.uri &lt;chr&gt;,
## #   added_by.external_urls.spotify &lt;chr&gt;, track.artists &lt;list&gt;,
## #   track.available_markets &lt;list&gt;, track.disc_number &lt;int&gt;,
## #   track.duration_ms &lt;int&gt;, track.episode &lt;lgl&gt;, track.explicit &lt;lgl&gt;,
## #   track.href &lt;chr&gt;, track.is_local &lt;lgl&gt;, track.name &lt;chr&gt;,
## #   track.popularity &lt;int&gt;, track.preview_url &lt;chr&gt;, track.track &lt;lgl&gt;,
## #   track.track_number &lt;int&gt;, track.type &lt;chr&gt;, track.uri &lt;chr&gt;,
## #   track.album.album_type &lt;chr&gt;, track.album.artists &lt;list&gt;,
## #   track.album.available_markets &lt;list&gt;, track.album.href &lt;chr&gt;,
## #   track.album.id &lt;chr&gt;, track.album.images &lt;list&gt;, track.album.name &lt;chr&gt;,
## #   track.album.release_date &lt;chr&gt;, track.album.release_date_precision &lt;chr&gt;,
## #   track.album.total_tracks &lt;int&gt;, track.album.type &lt;chr&gt;,
## #   track.album.uri &lt;chr&gt;, track.album.external_urls.spotify &lt;chr&gt;,
## #   track.external_ids.isrc &lt;chr&gt;, track.external_urls.spotify &lt;chr&gt;,
## #   video_thumbnail.url &lt;lgl&gt;, key_name &lt;chr&gt;, mode_name &lt;chr&gt;, key_mode &lt;chr&gt;
</code></pre><p>This would be perfect for exploring the audio features on their own. On the other hand, this is going to be pretty difficult to match up to the songs in the <code>rankings</code> dataset because both the titles and artists are significantly different, so let&rsquo;s take a different approach. Let&rsquo;s create a little function to find the Spotify track identifier via <code>search_spotify()</code> (Spotify has already handled search pretty well) and use <code>purrr::map()</code> to apply it to all the songs we have in our dataset.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">pull_id <span style="color:#666">&lt;-</span> <span style="color:#06287e">function</span>(query) {
  <span style="color:#06287e">search_spotify</span>(query, <span style="color:#4070a0">&#34;track&#34;</span>) <span style="color:#666">%&gt;%</span>
    <span style="color:#06287e">arrange</span>(<span style="color:#666">-</span>popularity) <span style="color:#666">%&gt;%</span>
    <span style="color:#06287e">filter</span>(<span style="color:#06287e">row_number</span>() <span style="color:#666">==</span> <span style="color:#40a070">1</span>) <span style="color:#666">%&gt;%</span>
    <span style="color:#06287e">pull</span>(id)
}

ranking_ids <span style="color:#666">&lt;-</span> rankings <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">mutate</span>(
    search_query <span style="color:#666">=</span> <span style="color:#06287e">paste</span>(title, artist),
    search_query <span style="color:#666">=</span> <span style="color:#06287e">str_to_lower</span>(search_query),
    search_query <span style="color:#666">=</span> <span style="color:#06287e">str_remove</span>(search_query, <span style="color:#4070a0">&#34;ft.*$&#34;</span>)
  ) <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">mutate</span>(id <span style="color:#666">=</span> <span style="color:#06287e">map_chr</span>(search_query, <span style="color:#06287e">possibly</span>(pull_id, <span style="color:#007020;font-weight:bold">NA_character_</span>)))

ranking_ids <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">select</span>(title, artist, id)
</code></pre></div><pre tabindex="0"><code>## # A tibble: 311 x 3
##    title                  artist                            id                  
##    &lt;chr&gt;                  &lt;chr&gt;                             &lt;chr&gt;               
##  1 Juicy                  The Notorious B.I.G.              5ByAIlEEnxYdvpnezg7â€¦
##  2 Fight The Power        Public Enemy                      1yo16b3u0lptm6Cs7lxâ€¦
##  3 Shook Ones (Part II)   Mobb Deep                         4nASzyRbzL5qZQuOPjQâ€¦
##  4 The Message            Grandmaster Flash &amp; The Furious â€¦ 5DuTNKFEjJIySAyJH1yâ€¦
##  5 Nuthinâ€™ But A â€˜Gâ€™ Thaâ€¦ Dr Dre ft. Snoop Doggy Dogg       4YtoipFgf4k0AfD17Zfâ€¦
##  6 C.R.E.A.M.             Wu-Tang Clan                      119c93MHjrDLJTApCVGâ€¦
##  7 93 â€™Til Infinity       Souls of Mischief                 0PV1TFUMTBrDETzW6KQâ€¦
##  8 Passinâ€™ Me By          The Pharcyde                      4G3dZN9o3o2X4VKwt4Câ€¦
##  9 N.Y. State Of Mind     Nas                               5zwz05jkQVT68CjUpPwâ€¦
## 10 Dear Mama              2Pac                              6tDxrq4FxEL2q15y37tâ€¦
## # â€¦ with 301 more rows
</code></pre><p>At the end of that, there are 6% of songs that I failed to find a Spotify track identifier for. Not too bad!</p>
<p>Now that we have the track identifiers, we can get the audio features. The function <code>get_track_audio_features()</code> can only take 100 tracks at most at once, so let&rsquo;s divide up our tracks into smaller chunks and then <code>map()</code> through them.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">ranking_features <span style="color:#666">&lt;-</span> ranking_ids <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">mutate</span>(id_group <span style="color:#666">=</span> <span style="color:#06287e">row_number</span>() <span style="color:#666">%/%</span> <span style="color:#40a070">80</span>) <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">select</span>(id_group, id) <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">nest</span>(data <span style="color:#666">=</span> <span style="color:#06287e">c</span>(id)) <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">mutate</span>(audio_features <span style="color:#666">=</span> <span style="color:#06287e">map</span>(data, <span style="color:#666">~</span> <span style="color:#06287e">get_track_audio_features</span>(.$id)))

ranking_features
</code></pre></div><pre tabindex="0"><code>## # A tibble: 4 x 3
##   id_group data              audio_features    
##      &lt;dbl&gt; &lt;list&gt;            &lt;list&gt;            
## 1        0 &lt;tibble [79 Ã— 1]&gt; &lt;tibble [79 Ã— 18]&gt;
## 2        1 &lt;tibble [80 Ã— 1]&gt; &lt;tibble [80 Ã— 18]&gt;
## 3        2 &lt;tibble [80 Ã— 1]&gt; &lt;tibble [80 Ã— 18]&gt;
## 4        3 &lt;tibble [72 Ã— 1]&gt; &lt;tibble [72 Ã— 18]&gt;
</code></pre><p>We have audio features! ðŸŽ‰ Now let&rsquo;s put that together with the rankings and create a dataframe for modeling.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">ranking_df <span style="color:#666">&lt;-</span> ranking_ids <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">bind_cols</span>(ranking_features <span style="color:#666">%&gt;%</span>
    <span style="color:#06287e">select</span>(audio_features) <span style="color:#666">%&gt;%</span>
    <span style="color:#06287e">unnest</span>(audio_features)) <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">select</span>(title, artist, points, year, danceability<span style="color:#666">:</span>tempo) <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">na.omit</span>()

ranking_df
</code></pre></div><pre tabindex="0"><code>## # A tibble: 293 x 15
##    title artist points  year danceability energy   key loudness  mode
##    &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;int&gt;
##  1 Juicy The Nâ€¦    140  1994        0.889  0.816     9    -4.67     1
##  2 Fighâ€¦ Publiâ€¦    100  1989        0.797  0.582     2   -13.0      1
##  3 Shooâ€¦ Mobb â€¦     94  1995        0.637  0.878     6    -5.51     1
##  4 The â€¦ Grandâ€¦     90  1982        0.947  0.607    10   -10.6      0
##  5 Nuthâ€¦ Dr Drâ€¦     84  1992        0.801  0.699    11    -8.18     0
##  6 C.R.â€¦ Wu-Taâ€¦     62  1993        0.479  0.549    11   -10.6      0
##  7 93 â€™â€¦ Soulsâ€¦     50  1993        0.59   0.672     1   -11.8      1
##  8 Passâ€¦ The Pâ€¦     48  1992        0.759  0.756     4    -8.14     0
##  9 N.Y.â€¦ Nas        46  1994        0.665  0.91      6    -4.68     0
## 10 Dearâ€¦ 2Pac       42  1995        0.773  0.54      6    -7.12     1
## # â€¦ with 283 more rows, and 6 more variables: speechiness &lt;dbl&gt;,
## #   acousticness &lt;dbl&gt;, instrumentalness &lt;dbl&gt;, liveness &lt;dbl&gt;, valence &lt;dbl&gt;,
## #   tempo &lt;dbl&gt;
</code></pre><p>How are these quantities correlated with each other?</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#06287e">library</span>(corrr)

ranking_df <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">select</span>(year<span style="color:#666">:</span>tempo) <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">correlate</span>() <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">rearrange</span>() <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">shave</span>() <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">rplot</span>(shape <span style="color:#666">=</span> <span style="color:#40a070">15</span>, colours <span style="color:#666">=</span> <span style="color:#06287e">c</span>(<span style="color:#4070a0">&#34;darkorange&#34;</span>, <span style="color:#4070a0">&#34;white&#34;</span>, <span style="color:#4070a0">&#34;darkcyan&#34;</span>)) <span style="color:#666">+</span>
  <span style="color:#06287e">theme_plex</span>()
</code></pre></div><img src="/blog/best-hip-hop/index_files/figure-html/unnamed-chunk-8-1.png" width="3000" />
<p>Louder songs have higher energy, and older songs tend to be more danceable and have higher valence (i.e. be more &ldquo;happy&rdquo;).</p>
<p>Let&rsquo;s train a linear model on these audio features.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">ranking_lm <span style="color:#666">&lt;-</span> ranking_df <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">select</span>(<span style="color:#666">-</span>title, <span style="color:#666">-</span>artist) <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">lm</span>(<span style="color:#06287e">log</span>(points) <span style="color:#666">~</span> ., data <span style="color:#666">=</span> .)

<span style="color:#06287e">summary</span>(ranking_lm)
</code></pre></div><pre tabindex="0"><code>## 
## Call:
## lm(formula = log(points) ~ ., data = .)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.68521 -0.58721  0.05728  0.44134  2.63178 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      68.2251604 13.9295818   4.898 1.64e-06 ***
## year             -0.0329381  0.0068396  -4.816 2.40e-06 ***
## danceability      0.0068425  0.4409221   0.016    0.988    
## energy           -0.0487288  0.4372164  -0.111    0.911    
## key               0.0091604  0.0137126   0.668    0.505    
## loudness          0.0360689  0.0226039   1.596    0.112    
## mode             -0.0690822  0.1041311  -0.663    0.508    
## speechiness      -0.2697032  0.4118937  -0.655    0.513    
## acousticness      0.4754636  0.3003998   1.583    0.115    
## instrumentalness -0.6862222  0.8101330  -0.847    0.398    
## liveness          0.0811289  0.2604150   0.312    0.756    
## valence          -0.3930333  0.2859187  -1.375    0.170    
## tempo             0.0008642  0.0016334   0.529    0.597    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.8288 on 280 degrees of freedom
## Multiple R-squared:  0.09513,	Adjusted R-squared:  0.05635 
## F-statistic: 2.453 on 12 and 280 DF,  p-value: 0.004697
</code></pre><p>We only have evidence for year being important in the critic ratings from this model. We know that some of the features are at least a bit correlated, though, so let&rsquo;s use PCA.</p>




<h2 id="principal-component-analysis">Principal component analysis
  <a href="#principal-component-analysis"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h2>
<p>We can use the 
<a href="https://tidymodels.github.io/recipes/" target="_blank" rel="noopener">recipes</a> package to implement PCA in tidymodels.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#06287e">library</span>(tidymodels)

ranking_rec <span style="color:#666">&lt;-</span> <span style="color:#06287e">recipe</span>(points <span style="color:#666">~</span> ., data <span style="color:#666">=</span> ranking_df) <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">update_role</span>(title, artist, new_role <span style="color:#666">=</span> <span style="color:#4070a0">&#34;id&#34;</span>) <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">step_log</span>(points) <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">step_normalize</span>(<span style="color:#06287e">all_predictors</span>()) <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">step_pca</span>(<span style="color:#06287e">all_predictors</span>())

ranking_prep <span style="color:#666">&lt;-</span> <span style="color:#06287e">prep</span>(ranking_rec)

ranking_prep
</code></pre></div><pre tabindex="0"><code>## Data Recipe
## 
## Inputs:
## 
##       role #variables
##         id          2
##    outcome          1
##  predictor         12
## 
## Training data contained 293 data points and no missing data.
## 
## Operations:
## 
## Log transformation on points [trained]
## Centering and scaling for year, danceability, energy, key, loudness, ... [trained]
## PCA extraction with year, danceability, energy, key, loudness, ... [trained]
</code></pre><p>Let&rsquo;s walk through the steps in this recipe.</p>
<ul>
<li>First, we must tell the <code>recipe()</code> what our model is going to be (using a formula here) and what data we are using.</li>
<li>Next, we update the role for title and artist, since these are variables we want to keep around for convenience as identifiers for rows but are not a predictor or outcome.</li>
<li>Next, we take the log of the outcome (<code>points</code>, the critic ratings).</li>
<li>We need to center and scale the numeric predictors, because we are about to implement PCA.</li>
<li>Finally, we use <code>step_pca()</code> for the actual principal component analysis.</li>
</ul>
<p>Before using <code>prep()</code> these steps have been defined but not actually run or implemented. The <code>prep()</code> function is where everything gets evaluated.</p>
<p>Once we have that done, we can both explore the results of the PCA and then eventually use it in a model. Let&rsquo;s start with checking out how the PCA turned out. We can <code>tidy()</code> any of our recipe steps, including the PCA step, which is the third step. Then let&rsquo;s make a visualization to see what the components look like.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">tidied_pca <span style="color:#666">&lt;-</span> <span style="color:#06287e">tidy</span>(ranking_prep, <span style="color:#40a070">3</span>)

tidied_pca <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">mutate</span>(component <span style="color:#666">=</span> <span style="color:#06287e">fct_inorder</span>(component)) <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">ggplot</span>(<span style="color:#06287e">aes</span>(value, terms, fill <span style="color:#666">=</span> terms)) <span style="color:#666">+</span>
  <span style="color:#06287e">geom_col</span>(show.legend <span style="color:#666">=</span> <span style="color:#007020;font-weight:bold">FALSE</span>) <span style="color:#666">+</span>
  <span style="color:#06287e">facet_wrap</span>(<span style="color:#666">~</span>component) <span style="color:#666">+</span>
  <span style="color:#06287e">labs</span>(y <span style="color:#666">=</span> <span style="color:#007020;font-weight:bold">NULL</span>)
</code></pre></div><img src="/blog/best-hip-hop/index_files/figure-html/unnamed-chunk-11-1.png" width="1800" />
<p>Let&rsquo;s zoom in on the first four components.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#06287e">library</span>(tidytext)

tidied_pca <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">filter</span>(component <span style="color:#666">%in%</span> <span style="color:#06287e">c</span>(<span style="color:#4070a0">&#34;PC1&#34;</span>, <span style="color:#4070a0">&#34;PC2&#34;</span>, <span style="color:#4070a0">&#34;PC3&#34;</span>, <span style="color:#4070a0">&#34;PC4&#34;</span>)) <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">group_by</span>(component) <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">top_n</span>(<span style="color:#40a070">6</span>, <span style="color:#06287e">abs</span>(value)) <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">ungroup</span>() <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">mutate</span>(terms <span style="color:#666">=</span> <span style="color:#06287e">reorder_within</span>(terms, <span style="color:#06287e">abs</span>(value), component)) <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">ggplot</span>(<span style="color:#06287e">aes</span>(<span style="color:#06287e">abs</span>(value), terms, fill <span style="color:#666">=</span> value <span style="color:#666">&gt;</span> <span style="color:#40a070">0</span>)) <span style="color:#666">+</span>
  <span style="color:#06287e">geom_col</span>() <span style="color:#666">+</span>
  <span style="color:#06287e">facet_wrap</span>(<span style="color:#666">~</span>component, scales <span style="color:#666">=</span> <span style="color:#4070a0">&#34;free_y&#34;</span>) <span style="color:#666">+</span>
  <span style="color:#06287e">scale_y_reordered</span>() <span style="color:#666">+</span>
  <span style="color:#06287e">labs</span>(
    x <span style="color:#666">=</span> <span style="color:#4070a0">&#34;Absolute value of contribution&#34;</span>,
    y <span style="color:#666">=</span> <span style="color:#007020;font-weight:bold">NULL</span>, fill <span style="color:#666">=</span> <span style="color:#4070a0">&#34;Positive?&#34;</span>
  )
</code></pre></div><img src="/blog/best-hip-hop/index_files/figure-html/unnamed-chunk-12-1.png" width="2400" />
<p>So PC1 is mostly about age and danceability, PC2 is mostly energy and loudness, PC3 is mostly speechiness, and PC4 is about the musical characteristics (actual key and major vs. minor key).</p>
<p>How are the songs distributed in the plane of the first two components?</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#06287e">juice</span>(ranking_prep) <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">ggplot</span>(<span style="color:#06287e">aes</span>(PC1, PC2, label <span style="color:#666">=</span> title)) <span style="color:#666">+</span>
  <span style="color:#06287e">geom_point</span>(alpha <span style="color:#666">=</span> <span style="color:#40a070">0.2</span>) <span style="color:#666">+</span>
  <span style="color:#06287e">geom_text</span>(check_overlap <span style="color:#666">=</span> <span style="color:#007020;font-weight:bold">TRUE</span>, family <span style="color:#666">=</span> <span style="color:#4070a0">&#34;IBMPlexSans&#34;</span>)
</code></pre></div><img src="/blog/best-hip-hop/index_files/figure-html/unnamed-chunk-13-1.png" width="3000" />
<ul>
<li>Older, more danceable songs are to the left.</li>
<li>Higher energy, louder songs are towards the top.</li>
</ul>
<p>You can change out <code>PC2</code> for <code>PC3</code>, for example, to instead see where more &ldquo;speechy&rdquo; songs are.</p>
<p>How much variation are we capturing?</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">sdev <span style="color:#666">&lt;-</span> ranking_prep<span style="color:#666">$</span>steps[[3]]<span style="color:#666">$</span>res<span style="color:#666">$</span>sdev

percent_variation <span style="color:#666">&lt;-</span> sdev^2 <span style="color:#666">/</span> <span style="color:#06287e">sum</span>(sdev^2)

<span style="color:#06287e">tibble</span>(
  component <span style="color:#666">=</span> <span style="color:#06287e">unique</span>(tidied_pca<span style="color:#666">$</span>component),
  percent_var <span style="color:#666">=</span> percent_variation <span style="color:#60a0b0;font-style:italic">## use cumsum() to find cumulative, if you prefer</span>
) <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">mutate</span>(component <span style="color:#666">=</span> <span style="color:#06287e">fct_inorder</span>(component)) <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">ggplot</span>(<span style="color:#06287e">aes</span>(component, percent_var)) <span style="color:#666">+</span>
  <span style="color:#06287e">geom_col</span>() <span style="color:#666">+</span>
  <span style="color:#06287e">scale_y_continuous</span>(labels <span style="color:#666">=</span> scales<span style="color:#666">::</span><span style="color:#06287e">percent_format</span>()) <span style="color:#666">+</span>
  <span style="color:#06287e">labs</span>(x <span style="color:#666">=</span> <span style="color:#007020;font-weight:bold">NULL</span>, y <span style="color:#666">=</span> <span style="color:#4070a0">&#34;Percent variance explained by each PCA component&#34;</span>)
</code></pre></div><img src="/blog/best-hip-hop/index_files/figure-html/unnamed-chunk-14-1.png" width="2400" />
<p>And finally, let&rsquo;s fit the same kind of model we fit before, but now with <code>juice(ranking_prep)</code>. This approach really emphasizes how recipes can be used for data preprocessing. Notice how <code>juice(ranking_prep)</code> has already taken the log of <code>points</code>, has the component values ready to go, etc.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#06287e">juice</span>(ranking_prep)
</code></pre></div><pre tabindex="0"><code>## # A tibble: 293 x 8
##    title        artist             points     PC1    PC2     PC3    PC4      PC5
##    &lt;fct&gt;        &lt;fct&gt;               &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
##  1 Juicy        The Notorious B.Iâ€¦   4.94 -0.987   0.904 -1.10    1.16   5.46e-1
##  2 Fight The Pâ€¦ Public Enemy         4.61 -0.837  -1.42   0.686   0.184 -1.78e+0
##  3 Shook Ones â€¦ Mobb Deep            4.54  0.0153  1.06  -0.929   0.681 -3.27e-1
##  4 The Message  Grandmaster Flashâ€¦   4.50 -3.42    0.138 -0.0333 -0.653 -2.63e-4
##  5 Nuthinâ€™ Butâ€¦ Dr Dre ft. Snoop â€¦   4.43 -1.90    0.405 -0.629  -1.18   8.27e-2
##  6 C.R.E.A.M.   Wu-Tang Clan         4.13  0.190  -2.25  -1.94   -0.245  2.80e+0
##  7 93 â€™Til Infâ€¦ Souls of Mischief    3.91  0.413  -0.892 -0.576   1.93   1.20e+0
##  8 Passinâ€™ Me â€¦ The Pharcyde         3.87 -0.990   0.289 -0.607  -0.615 -1.01e+0
##  9 N.Y. State â€¦ Nas                  3.83 -0.819   1.93  -1.41   -0.736 -5.23e-1
## 10 Dear Mama    2Pac                 3.74 -0.143  -0.698  1.19    0.349 -4.05e-1
## # â€¦ with 283 more rows
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">pca_fit <span style="color:#666">&lt;-</span> <span style="color:#06287e">juice</span>(ranking_prep) <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">select</span>(<span style="color:#666">-</span>title, <span style="color:#666">-</span>artist) <span style="color:#666">%&gt;%</span>
  <span style="color:#06287e">lm</span>(points <span style="color:#666">~</span> ., data <span style="color:#666">=</span> .)

<span style="color:#06287e">summary</span>(pca_fit)
</code></pre></div><pre tabindex="0"><code>## 
## Call:
## lm(formula = points ~ ., data = .)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.55257 -0.58620  0.04886  0.39583  2.89017 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.92516    0.04944  38.936   &lt;2e-16 ***
## PC1         -0.07547    0.03487  -2.165   0.0312 *  
## PC2          0.03540    0.03725   0.950   0.3428    
## PC3         -0.07129    0.04207  -1.695   0.0912 .  
## PC4         -0.03100    0.04520  -0.686   0.4934    
## PC5         -0.04195    0.04749  -0.883   0.3778    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.8463 on 287 degrees of freedom
## Multiple R-squared:  0.03273,	Adjusted R-squared:  0.01588 
## F-statistic: 1.942 on 5 and 287 DF,  p-value: 0.08738
</code></pre><p>So what did we find? There is some evidence here that older, more danceable, higher valence songs (PC1) were rated higher by critics.</p>

        
        <details closed class="f6 fw7 input-reset">
  <dl class="f6 lh-copy">
    <dt class="fw7">Posted on:</dt>
    <dd class="fw5 ml0">April 14, 2020</dd>
  </dl>
  <dl class="f6 lh-copy">
    <dt class="fw7">Length:</dt>
    <dd class="fw5 ml0">12 minute read, 2491 words</dd>
  </dl>
  
  <dl class="f6 lh-copy">
    <dt class="fw7">Categories:</dt>
    <dd class="fw5 ml0"> <a href="https://juliasilge.com/categories/rstats">rstats</a>  <a href="https://juliasilge.com/categories/tidymodels">tidymodels</a> </dd>
  </dl>
  
  
  
  <dl class="f6 lh-copy">
    <dt class="fw7">Tags:</dt>
    <dd class="fw5 ml0"> <a href="https://juliasilge.com/tags/rstats">rstats</a>  <a href="https://juliasilge.com/tags/tidymodels">tidymodels</a> </dd>
  </dl>
  
  <dl class="f6 lh-copy">
    <dt class="fw7">See Also:</dt>
    
    <dd class="fw5 ml0"><a href="/blog/educational-attainment/">Educational attainment in #TidyTuesday UK towns</a></dd>
    
    <dd class="fw5 ml0"><a href="/blog/polling-places/">Changes in #TidyTuesday US polling places</a></dd>
    
    <dd class="fw5 ml0"><a href="/blog/doctor-who-bayes/">Empirical Bayes for #TidyTuesday Doctor Who episodes</a></dd>
    
  </dl>
</details>

      </section>
      <footer class="post-footer">
        <div class="post-pagination dt w-100 mt4 mb2">
  
  
    <a class="prev dtc pr2 tl v-top fw6"
    href="https://juliasilge.com/blog/gdpr-violations/">&larr; Modeling #TidyTuesday GDPR violations with tidymodels</a>
  
  
  
    <a class="next dtc pl2 tr v-top fw6"
    href="https://juliasilge.com/blog/beer-production/">Bootstrap resampling with #TidyTuesday beer production data &rarr;</a>
  
</div>

      </footer>
    </article>
    
      
<div class="post-comments pa0 pa4-l mt4">
  
  <script src="https://utteranc.es/client.js"
          repo="juliasilge/juliasilge.com"
          issue-term="title"
          theme="github-light"
          label="comments :speech_balloon:"
          crossorigin="anonymous"
          async
          type="text/javascript">
  </script>
  
</div>

    
  </section>
</main>
<footer class="site-footer pv4 bt b--transparent ph5" role="contentinfo">
  <nav class="db dt-l w-100">
    <p class="site-copyright f7 db dtc-l v-mid w-100 w-33-l tc tl-l pv2 pv0-l mv0 lh-copy">
      &copy; 2024 Julia Silge
      <span class="middot-divider"></span>
      Made with <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/hugo-apero/" rel="dct:source">Hugo ApÃ©ro</a></span>.
      <br />
      
Based on <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/formspree/blogophonic-hugo" rel="dct:source">Blogophonic</a></span> by <a xmlns:cc="http://creativecommons.org/ns#" href="https://formspree.io" property="cc:attributionName" rel="cc:attributionURL">Formspree</a>.
    </p>
    
    <div class="site-links f6 db dtc-l v-mid w-100 w-67-l tc tr-l pv2 pv0-l mv0">
      
      <a class="dib pv1 ph2 link" href="/license/" title="License">License</a>
      
    </div>
  </nav>
  
    <script>

    var i, text, code, codes = document.getElementsByTagName('code');
    for (let i = 0; i < codes.length;) {
      code = codes[i];
      if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
        text = code.textContent;
        if (/^\$[^$]/.test(text) && /[^$]\$$/.test(text)) {
          text = text.replace(/^\$/, '\\(').replace(/\$$/, '\\)');
          code.textContent = text;
        }
        if (/^\\\((.|\s)+\\\)$/.test(text) ||
            /^\\\[(.|\s)+\\\]$/.test(text) ||
            /^\$(.|\s)+\$$/.test(text) ||
            /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
          code.outerHTML = code.innerHTML;  
          continue;
        }
      }
      i++;
    }
</script>

  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js" integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>



    
  
  
</footer>

      </div>
    </body>
</html>
